<% include ./partials/header.ejs %>

<div class="w-full min-h-screen bg-zinc-800 flex flex-col items-center justify-center gap-3">

  <!-- Hidden Upload Form -->
  <form id="uploadform" hidden action="/fileupload" method="post" enctype="multipart/form-data">
    <input type="file" name="image" accept="image/*">
  </form>

  <!-- Profile Image -->
  <div class="relative w-28 h-28">
    <img 
      src="/images/uploads/<%= user.profileimage %>" 
      alt="profile"
      class="w-full h-full rounded-full object-cover"
    >

    <!-- Edit Icon -->
    <span 
      id="uploadpen"
      class="absolute bottom-1 right-1 bg-white p-2 rounded-full cursor-pointer shadow-md hover:bg-gray-200"
    >
      <i class="ri-pencil-fill text-gray-700 text-sm"></i>
    </span>
  </div>

  <!-- Name -->
  <h1 class="mt-2 text-xl font-semibold text-white">
    <%= user.username %>
  </h1>

  <!-- Username -->
  <p class="text-gray-400">
    @<%= user.name %>
  </p>

  <!-- Buttons -->
  <a href="/edit-profile" class="bg-white rounded-full text-gray-700 px-6 py-2 mt-2">
    Edit Profile
  </a>

  <a href="/add" class="bg-red-600 rounded-full text-white px-6 py-2">
    Create New Post
  </a>

  <!-- Post Card -->
  <div class="w-64 bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition mt-4">

    <% if(user.posts.length > 0){ %>
      <img 
        src="/images/uploads/<%= user.posts[0].image %>"
        alt="card image"
        class="w-full h-64 object-cover"
      />
    <% } else { %>
      <div class="h-64 flex items-center justify-center text-gray-400">
        No posts yet
      </div>
    <% } %>

    <div class="p-3">
      <a href="/show" class="text-sm font-semibold text-gray-800">
        Uploaded Pins
      </a>
      <p class="text-xs text-gray-500 mt-1">
        <%= user.posts.length %>
      </p>
    </div>
  </div>

</div>

<!-- Script -->
<script>
  document.querySelector("#uploadpen").addEventListener("click", () => {
    document.querySelector("#uploadform input").click();
  });

  document.querySelector("#uploadform input").addEventListener("change", () => {
    document.querySelector("#uploadform").submit();
  });
</script>

<% include ./partials/footer.ejs %>
